# ADR-0001: 使用领域驱动设计（DDD）

**状态**: 已采用  
**日期**: 2025-12-01  
**决策者**: 架构团队

## 上下文

游戏引擎需要管理复杂的业务逻辑，包括音频播放、物理模拟、场景管理等。传统的贫血模型（Anemic Domain Model）会导致业务逻辑分散，难以维护和测试。

## 决策

采用领域驱动设计（DDD）模式，实现富领域对象（Rich Domain Model）：
- 将业务逻辑封装到领域对象中
- 使用聚合根管理实体集合
- 通过领域服务协调领域对象
- 使用值对象封装领域概念

## 后果

### 优点
- **业务逻辑集中**: 业务规则封装在领域对象中，易于理解和维护
- **可测试性**: 领域对象可以独立测试，不依赖基础设施
- **一致性**: 业务规则在聚合边界内执行，保证一致性
- **可扩展性**: 新功能可以通过扩展领域对象实现

### 缺点
- **学习曲线**: 团队需要理解DDD概念
- **代码量**: 需要更多的领域对象和服务层代码
- **性能**: 可能增加一些间接调用开销（但影响很小）

### 实施细节
- 领域对象位于 `src/domain/` 目录
- 服务层位于 `src/services/` 目录
- 使用依赖注入容器管理服务依赖

## 替代方案

1. **贫血模型**: 业务逻辑在服务层，领域对象只有数据
   - 拒绝原因: 业务逻辑分散，难以维护

2. **事务脚本**: 每个用例一个脚本
   - 拒绝原因: 不适合复杂业务逻辑

3. **CQRS**: 命令查询职责分离
   - 未来考虑: 如果查询性能成为瓶颈，可以考虑

## 相关决策

- ADR-0002: 使用Actor模式进行并发控制
- ADR-0003: 错误处理和恢复策略



