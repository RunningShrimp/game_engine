# ADR-0005: 使用Bevy ECS进行实体管理

**状态**: 已采用  
**日期**: 2025-12-01  
**决策者**: 架构团队

## 上下文

游戏引擎需要高效管理大量游戏对象，传统的面向对象方法可能导致性能问题和内存碎片。

## 决策

使用Bevy ECS进行实体管理：
- Bevy ECS是Rust的高性能ECS实现
- 使用SoA（Structure of Arrays）布局提升缓存命中率
- 支持系统并行执行
- 类型安全的查询系统

## 后果

### 优点
- **性能**: SoA布局提升缓存命中率，系统可以并行执行
- **类型安全**: Rust类型系统保证查询安全
- **可组合性**: 组件可以自由组合
- **可测试性**: 系统可以独立测试

### 缺点
- **学习曲线**: 团队需要理解ECS概念
- **代码组织**: 需要将逻辑组织为系统
- **调试**: ECS调试可能更困难

### 实施细节
- ECS组件位于 `src/ecs/mod.rs`
- 系统位于 `src/core/systems.rs`
- 使用Bevy ECS的 `World` 和 `Schedule` 管理实体和系统

## 替代方案

1. **自定义ECS**: 自己实现ECS系统
   - 拒绝原因: 开发成本高，Bevy ECS已经成熟

2. **面向对象**: 使用传统的类和继承
   - 拒绝原因: 性能较差，难以并行化

3. **legion**: 使用Legion ECS
   - 拒绝原因: Bevy ECS更活跃，API更友好

## 相关决策

- ADR-0004: 使用wgpu进行渲染
- ADR-0001: 使用领域驱动设计



